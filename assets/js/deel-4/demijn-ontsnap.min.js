var interval,character=document.getElementById("character"),game=document.getElementById("game"),both=0,counter=0,currentBlocks=[];let successModal=document.querySelector("#modal-window");successModal.classList.add("hideModal");let failureModal=document.querySelector("#modal-window-failure");failureModal.classList.add("hideModal");var leftBtn=document.getElementById("js--left"),rightBtn=document.getElementById("js--right");function moveLeft(){var e=parseInt(window.getComputedStyle(character).getPropertyValue("left"));e>0&&(character.style.left=e-2+"px")}function moveRight(){var e=parseInt(window.getComputedStyle(character).getPropertyValue("left"));e<280&&(character.style.left=e+2+"px")}leftBtn.addEventListener("touchstart",e=>{0==both&&(both++,interval=setInterval(moveLeft,1))}),rightBtn.addEventListener("touchstart",e=>{0==both&&(both++,interval=setInterval(moveRight,1))}),leftBtn.addEventListener("touchend",e=>{clearInterval(interval),both=0}),rightBtn.addEventListener("touchend",e=>{clearInterval(interval),both=0}),document.addEventListener("keydown",e=>{0==both&&(both++,"ArrowLeft"===e.key&&(interval=setInterval(moveLeft,1)),"ArrowRight"===e.key&&(interval=setInterval(moveRight,1)))}),document.addEventListener("keyup",e=>{clearInterval(interval),both=0});var blocks=setInterval(function(){var e=document.getElementById("block"+(counter-1)),t=document.getElementById("hole"+(counter-1));if(counter>0)var o=parseInt(window.getComputedStyle(e).getPropertyValue("top")),r=parseInt(window.getComputedStyle(t).getPropertyValue("top"));function l(e){if(e.matches){if(o<400||0==counter){let e=document.createElement("div"),t=document.createElement("div");e.setAttribute("class","block"),t.setAttribute("class","hole"),e.setAttribute("id","block"+counter),t.setAttribute("id","hole"+counter),e.style.top=o+80+"px",t.style.top=r+80+"px";let l=Math.floor(260*Math.random());t.style.left=l+"px",game.appendChild(e),game.appendChild(t),currentBlocks.push(counter),counter++}let e=parseInt(window.getComputedStyle(character).getPropertyValue("top")),t=parseInt(window.getComputedStyle(character).getPropertyValue("left")),l=0;if(e<=0){clearInterval(blocks),document.querySelector("#modal-window-failure").classList.add("showModal")}if(counter>=20){clearInterval(blocks),document.querySelector("#modal-window").classList.add("showModal")}for(let o=0;o<currentBlocks.length;o++){let r=currentBlocks[o],a=document.getElementById("block"+r),n=document.getElementById("hole"+r),c=parseFloat(window.getComputedStyle(a).getPropertyValue("top")),d=parseFloat(window.getComputedStyle(n).getPropertyValue("left"));a.style.top=c-.5+"px",n.style.top=c-.5+"px",c<-20&&(currentBlocks.shift(),a.remove(),n.remove()),c-10<e&&c>e&&(l++,d<=t&&d+20>=t&&(l=0))}0==l?e<440&&(character.style.top=e+2+"px"):character.style.top=e-.5+"px"}else{if(o<270||0==counter){let e=document.createElement("div"),t=document.createElement("div");e.setAttribute("class","block"),t.setAttribute("class","hole"),e.setAttribute("id","block"+counter),t.setAttribute("id","hole"+counter),e.style.top=o+80+"px",t.style.top=r+80+"px";let l=Math.floor(260*Math.random());t.style.left=l+"px",game.appendChild(e),game.appendChild(t),currentBlocks.push(counter),counter++}let e=parseInt(window.getComputedStyle(character).getPropertyValue("top")),t=parseInt(window.getComputedStyle(character).getPropertyValue("left")),l=0;if(e<=0){clearInterval(blocks),document.querySelector("#modal-window-failure").classList.add("showModal")}if(counter>=40){clearInterval(blocks),document.querySelector("#modal-window").classList.add("showModal")}for(let o=0;o<currentBlocks.length;o++){let r=currentBlocks[o],a=document.getElementById("block"+r),n=document.getElementById("hole"+r),c=parseFloat(window.getComputedStyle(a).getPropertyValue("top")),d=parseFloat(window.getComputedStyle(n).getPropertyValue("left"));a.style.top=c-.5+"px",n.style.top=c-.5+"px",c<-20&&(currentBlocks.shift(),a.remove(),n.remove()),c-10<e&&c>e&&(l++,d<=t&&d+20>=t&&(l=0))}0==l?e<340&&(character.style.top=e+2+"px"):character.style.top=e-.5+"px"}}var a=window.matchMedia("(min-width: 700px)");l(a),a.addListener(l)},1);
